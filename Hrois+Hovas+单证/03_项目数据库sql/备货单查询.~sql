SELECT DISTINCT PO.ORDER_NUM, --订单号
                SO.ORDER_PO_CODE, -- 客户PO
                PO.HGVS_ORDER_CODE AS ORDER_HGVS_CODE, --HGVS订单号    
                SO.CONTRACT_CODE, -- 合同号 
                CUST.NAME AS CUSTNAME, --客户   
                LO.SALE_ORG_NAME AS SALES_ORG_NAME, --销售组织    
                L.ITEM_NAME_CN AS SALES_CHENNEL, --销售渠道      
                PO.CHECK_CODE, -- 商检批次号
                PO.ACT_PREPARE_CODE, --备货单号
                PT.PROD_TYPE, --产品组
                DT.DEPT_NAME_CN, --生产工厂
                CY.NAME, --国家
                DTT.DEPT_NAME_CN AS DEPT_CODE, --经营体
                CYUI.NAME AS MANAGER_NAME, --产品经理
                PO.CREATED, --备货单分单时间
                PO.MANU_END_DATE, --系统交货期
                SOI.HAIER_MODEL, --海尔型号
                SOI.CUSTOMER_MODEL, --客户型号
                SOI.AFFIRM_NUM, --特技单号
                SOI.MATERIAL_CODE, --物料号
                POI.QUANTITY, --数量
                PO.FIRST_SAMPLE_DATE, --首样时间
                SO.ORDER_SHIP_DATE,
                PO.PACKING_START_DATE,
                PO.PACKING_END_DATE,
                PO.MANU_START_DATE,
                PO.CHECK_START_DATE,
                PO.CHECK_END_DATE,
                SUM(HPT.ORDER_FINISHED_COUNT) ORDER_FINISHED_COUNT,
                ACT.ACTUAL_FINISH_DATE, --商务审核时间
                ACTSCH.ACTUAL_FINISH_DATE AS SCH_FINISH_DATE, --计划排定结束时间
                ACTPAY.ACTUAL_FINISH_DATE AS PAY_FINISH_DATE, --付款保障
                BSP.BOOK_SHIP_DATE
FROM   ACT_PREPARE_ORDER PO
JOIN   ACT_PREPARE_ORDER_ITEM POI
ON     PO.ACT_PREPARE_CODE = POI.ACT_PREPARE_ORDER_CODE
LEFT   JOIN SO_SALES_ORDER SO
ON     PO.ORDER_NUM = SO.ORDER_CODE
JOIN   SO_SALES_ORDER_ITEM SOI
ON     (SOI.ORDER_CODE = PO.ORDER_NUM AND
       POI.MATERIAL_CODE = SOI.MATERIAL_CODE)
LEFT   JOIN CD_COUNTRY CY
ON     SO.COUNTRY_CODE = CY.COUNTRY_CODE
LEFT   JOIN USER_INFO CYUI
ON     CYUI.EMP_CODE = SO.ORDER_PROD_MANAGER
LEFT   JOIN CD_PROD_TYPE PT
ON     PT.PROD_TYPE_CODE = SOI.PROD_T_CODE
LEFT   JOIN CD_DEPARTMENT DT
ON     DT.DEPT_CODE = PO.FACTORY_PRODUCE_CODE
LEFT   JOIN CD_DEPARTMENT DTT
ON     DTT.DEPT_CODE = PO.DEPT_CODE
AND    DTT.DEPT_TYPE = '1'
LEFT   JOIN CD_CUSTOMER CUST
ON     SO.ORDER_SOLD_TO = CUST.CUSTOMER_CODE
LEFT   JOIN SYS_LOV L
ON     PO.SALES_CHENNEL = L.ITEM_CODE
LEFT   JOIN CD_SALE_ORG LO
ON     LO.SALE_ORG_CODE = PO.SALES_ORG_CODE
LEFT   JOIN SI_HGVS_PO_TRACK HPT
ON     (HPT.PREPARE_CODE = PO.ACT_PREPARE_CODE AND
       HPT.MATERIAL_CODE = POI.MATERIAL_CODE)
LEFT   JOIN SO_ACT ACT
ON     (SO.ORDER_CODE = ACT.ORDER_NUM AND
       ACT.ACT_ID = 'businessManagerSalesOrder')
LEFT   JOIN SO_ACT ACTSCH
ON     (SO.ORDER_CODE = ACTSCH.ORDER_NUM AND ACTSCH.ACT_ID = 'scheduling')
LEFT   JOIN SO_ACT ACTPAY
ON     (SO.ORDER_CODE = ACTPAY.ORDER_NUM AND ACTPAY.ACT_ID = 'payMoney#')
LEFT   JOIN SO_ACT ACTSUB
ON     (SO.ORDER_CODE = ACTSUB.ORDER_NUM AND
       ACTSUB.ACT_ID = 'subProcessNego')
LEFT   JOIN (SELECT SP.BOOK_SHIP_DATE,
                    BOI.ORDER_CODE,
                    BOI.ORDER_ITEM_CODE
             FROM   ACT_BOOK_ORDER_ITEM BOI,
                    ACT_SHIP_PAPER      SP
             WHERE  SP.BOOK_CODE = BOI.BOOK_CODE) BSP
ON     (BSP.ORDER_CODE = PO.ORDER_NUM AND
       BSP.ORDER_ITEM_CODE = SOI.ORDER_ITEM_LINECODE)
